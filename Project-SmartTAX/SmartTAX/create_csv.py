import csv
import os.path
import datetime
import random
import string
import pandas as pd

# -----------------------------------------------------------
# VAT 7 Percent
# -----------------------------------------------------------
def create_tiv():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_tax_invoice_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["TIV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_tiv_datetype2():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_tax_invoice_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["TIV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","0105561193TM_D271500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_tiv_datetype3():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_tax_invoice_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["TIV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","0105561193TM_D271500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_tiv_datetype4():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_tax_invoice_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["TIV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","0105561193TM_D271500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])


def create_receipt_tiv():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_tiv_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RTIV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_tiv_datetype2():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_tiv_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RTIV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_tiv_datetype3():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_tiv_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RTIV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_tiv_datetype4():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_tiv_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RTIV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_tiv():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_tiv_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["ITIV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_tiv_datetype2():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_tiv_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["ITIV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_tiv_datetype3():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_tiv_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["ITIV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_tiv_datetype4():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_tiv_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["ITIV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_do_tiv():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_delivey_order_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DTIV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_do_tiv_datetype2():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_delivey_order_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DTIV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_do_tiv_datetype3():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_delivey_order_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DTIV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_do_tiv_datetype4():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_delivey_order_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DTIV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RCP_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_datetype2():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RCP_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_datetype3():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RCP_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_datetype4():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RCP_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["INV_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_datetype2():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["INV_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_datetype3():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["INV_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_datetype4():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["INV_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","7",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_credit_note():

    # generate files name
    gdate = datetime.datetime.now()
    date =  str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_credit_note_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["CN_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_credit_note_datetype2():

    # generate files name
    gdate = datetime.datetime.now()
    date =  str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_credit_note_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["CN_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_credit_note_datetype3():

    # generate files name
    gdate = datetime.datetime.now()
    date =  str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_credit_note_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["CN_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_credit_note_datetype4():

    # generate files name
    gdate = datetime.datetime.now()
    date =  str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_credit_note_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["CN_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_debit_note():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_debit_note_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DN_NEW_VAT7_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_debit_note_datetype2():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_debit_note_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DN_NEW_VAT7_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_debit_note_datetype3():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_debit_note_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DN_NEW_VAT7_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_debit_note_datetype4():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_debit_note_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DN_NEW_VAT7_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","7","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])


# -----------------------------------------------------------
# VAT 0 Percent
# -----------------------------------------------------------
def create_tiv_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_tax_invoice_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["TIV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_tiv_datetype2_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_tax_invoice_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["TIV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","0105561193TM_D271500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_tiv_datetype3_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_tax_invoice_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["TIV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","0105561193TM_D271500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_tiv_datetype4_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_tax_invoice_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["TIV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","0105561193TM_D271500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])


def create_receipt_tiv_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_tiv_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RTIV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_tiv_datetype2_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_tiv_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RTIV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_tiv_datetype3_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_tiv_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RTIV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_tiv_datetype4_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_tiv_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RTIV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_tiv_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_tiv_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["ITIV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_tiv_datetype2_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_tiv_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["ITIV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_tiv_datetype3_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_tiv_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["ITIV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_tiv_datetype4_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_tiv_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["ITIV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_do_tiv_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_delivey_order_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DTIV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_do_tiv_datetype2_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_delivey_order_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DTIV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_do_tiv_datetype3_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_delivey_order_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DTIV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_do_tiv_datetype4_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_delivey_order_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DTIV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RCP_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_datetype2_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RCP_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_datetype3_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RCP_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_datetype4_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RCP_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["INV_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_datetype2_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["INV_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_datetype3_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["INV_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_datetype4_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["INV_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","0",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_credit_note_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date =  str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_credit_note_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["CN_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_credit_note_datetype2_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date =  str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_credit_note_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["CN_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_credit_note_datetype3_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date =  str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_credit_note_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["CN_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_credit_note_datetype4_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date =  str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_credit_note_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["CN_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_debit_note_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_debit_note_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DN_NEW_VAT0_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_debit_note_datetype2_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_debit_note_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DN_NEW_VAT0_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_debit_note_datetype3_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_debit_note_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DN_NEW_VAT0_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_debit_note_datetype4_zerovat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_debit_note_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DN_NEW_VAT0_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","0","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

                      
# -----------------------------------------------------------
# NON-VAT
# -----------------------------------------------------------
def create_tiv_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_tax_invoice_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["TIV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_tiv_datetype2_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_tax_invoice_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["TIV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","0105561193TM_D271500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_tiv_datetype3_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_tax_invoice_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["TIV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","0105561193TM_D271500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_tiv_datetype4_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_tax_invoice_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["TIV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["TIV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","0105561193TM_D271500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])


def create_receipt_tiv_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_tiv_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RTIV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_tiv_datetype2_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_tiv_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RTIV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_tiv_datetype3_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_tiv_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RTIV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_tiv_datetype4_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_tiv_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RTIV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RTIV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_tiv_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_tiv_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["ITIV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_tiv_datetype2_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_tiv_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["ITIV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_tiv_datetype3_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_tiv_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["ITIV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_tiv_datetype4_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_tiv_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["ITIV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["ITIV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_do_tiv_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_delivey_order_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DTIV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_do_tiv_datetype2_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_delivey_order_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DTIV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_do_tiv_datetype3_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_delivey_order_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DTIV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_do_tiv_datetype4_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_delivey_order_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DTIV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DTIV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบส่งของ/ใบกำกับภาษี","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RCP_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_datetype2_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RCP_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_datetype3_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RCP_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_receipt_datetype4_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_receipt_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["RCP_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["RCP_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเสร็จรับเงิน","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["INV_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_datetype2_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["INV_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_datetype3_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["INV_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_invoice_datetype4_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_invoice_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["INV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                                "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["INV_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบแจ้งหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                        "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","หัวข้อ","เนื้อหา","1","psc","3500","test","50","3500","เหตุผลส่วนลด","50","3400","non-vat",
                        "238","3400","3638","3500","เหตุผลส่วนลดท้ายบิล","100","3300","7","3300","231","0","0","3531","","","","","","","","","","สาเหตุการออกเอกสาร","","","",""])

def create_credit_note_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date =  str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_credit_note_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["CN_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_credit_note_datetype2_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date =  str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_credit_note_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["CN_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_credit_note_datetype3_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date =  str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_credit_note_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["CN_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_credit_note_datetype4_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date =  str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_credit_note_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["CN_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["CN_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบลดหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_debit_note_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"T00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_debit_note_datetype1.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DN_NEW_NVAT_ATM-D1_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_debit_note_datetype2_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_debit_note_datetype2.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DN_NEW_NVAT_ATM-D2_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_debit_note_datetype3_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)+" 00:00"
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_debit_note_datetype3.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DN_NEW_NVAT_ATM-D3_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])

def create_debit_note_datetype4_nonvat():

    # generate files name
    gdate = datetime.datetime.now()
    date = str(gdate.day)+"/"+str(gdate.month)+"/"+str(gdate.year)
    # print(gdate.day,gdate.month, gdate.year)
    files_path = '../csv/upload_debit_note_datetype4.csv'
    # N = 6
    # ref = ''.join(random.choices(string.ascii_uppercase +  string.digits, k = N)) 
    
    if os.path.isfile(files_path) == True:
        df = pd.read_csv(files_path)
        if df["วันที่ออกเอกสาร Issue date"][0] != date:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
        else:
                intdf = int(df["เลขที่เอกสารเฉพาะส่วน Running Number"][0])
                newint = intdf+1
                with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                        writer = csv.writer(file)
                        writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                                "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                                "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                                "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                                "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                                "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                        writer.writerow(["DN_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(newint),'{:05d}'.format(newint),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])
    else:
        with open(files_path, 'w', newline='',encoding="UTF-8") as file:
                writer = csv.writer(file)
                writer.writerow(["เลขที่เอกสารที่ส่งให้กรมสรรพากร (Document number)","เลขที่เอกสารเฉพาะส่วน Running Number","วันที่ออกเอกสาร Issue date","วันที่สร้างเอกสาร create date","หัวข้อ(Subject)","เนื้อหา(Content)","ชื่อ Seller name","ชื่อ seller name English","ชื่อสาขา Seller branch name","รหัสสาขาภายในองค์กร internal branch code","TAX ID (18 หลัก) Seller Tax ID 18 digit","ที่อยู่ Seller address","ที่อยู่ Seller address English","รหัสไปรษณีย์ Seller post code",
                        "ชื่อ Buyer name","สาขาผู้ซื้อBuyer branch","TAX ID (13 หลักหรือ18 หลัก) Buyer Tax ID","ที่อยู่ Buyer address","รหัสไปรษณีย์ Buyer post code","Buyer Country Code","ลำดับที่ (Item Number)","รายการสินค้า (Product Name)","รหัสสินค้า(Product Id)","หัวข้อ(Subject)","เนื้อหา(Content)","จำนวน (Quantity)","หน่วย (Unit)","ราคาต่อหน่วย(unit price)","เหตุผลส่วนลด/ค่าธรรมเนียม(ต่อชิ้น) Reason of discount per piece",
                        "ส่วนลด/ค่าธรรมเนียมต่อชิ้น(charge/discount per peice)","จำนวนเงิน (Line item amount after discount per piece)","เหตุผลส่วนลด/ค่าธรรมเนียม(สุดท้ายของบรรทัด) (Reason of discount end of item)","ส่วนลด/ค่าธรรมเนียมสุดท้ายของบรรทัด (Amount of discount end of item)","จำนวนเงินหลังส่วนลด/ค่าธรรมเนียมทั้งหมด (Line item amount after end of item discount)","ภาษีมูลค่าเพิ่ม %(percent vat for this line item)",
                        "ภาษีมูลค่าเพิ่ม (vat amount for this line item)","ค่าสินค้าไม่รวมภาษี (net line exclude vat)","ยอดชำระ(total payment)","จำนวนเงินรวม(รวม ก่อน discount) (Total amount before discount)","เหตุผลส่วนลด/ค่าธรรมเนียม(ท้ายบิล) Reason of discount end of bill","ส่วนลด/ค่าธรรมเนียม ท้ายบิล(Charge/Discount) Amount of discount end of bill","จำนวนเงินหลัง Discount(Total amount after discount)","ภาษีมูลค่าเพิ่ม% (รวม) (percent vat for total item)",
                        "รวมค่าสินค้าที่คิดภาษี (Total VAT 7% base amount)","จำนวนภาษีรวมมูลค่าเพิ่ม(รวม) (Total VAT amount)","รวมค่าสินค้าที่ 0% (Total VAT 0% amount)","รวมค่าสินค้าที่ non-vat (Total non-vat amount)","ยอดชำระทั้งสิ้น (Total payment)","รหัสเงื่อนไขการชาระเงิน (Payment term code)","รายละเอียดเงื่อนไขการชาระเงิน(Payment term Description)","วันครบกาหนดชาระเงิน(Payment Due Date Time)","Referenced Document Number (in system)","Type of referenced document",
                        "Referenced Document Number (Out system)","Issue date time of referenced document","จำนวนเงิน ไม่รวม VAT เอกสารเดิม (Original amount before VAT)","จำนวน VAT เอกสารเดิม (Original VAT)","สาเหตุการออกเอกสาร (Purpose of document)","E-mail","CC Email","ABB No.","Order No. (เลขที่คำสั่งซื้อ กรณีสั่งซื้อผ่าน Market Place)"])
                writer.writerow(["DN_NEW_NVAT_ATM-D4_"+str(gdate.year)+'{:02d}'.format(gdate.month)+'{:02d}'.format(gdate.day)+"_"+'{:05d}'.format(1),'{:05d}'.format(1),date,date,"ใบเพิ่มหนี้","เนื้อหา","บริษัท เบรนเนอร์จี้ จำกัด","Brainergy Co.,LTD",
                                "สำนักงานใหญ่","0","010556119371500000","499 ม.3 อาคารเบญจจินดา ถ.วิภาวดีรังสิต แขวงลาดยาว เขตจตุจักร","499 Benchachinda Bldg., Kamphaeng Phet 6 Road., Ladyao, Chatuchak, Bangkok 10900, Thailand","11000","คุณ ออโต้เทส อีแท็คออนไลน์","สำนักงานใหญ่","111000000000000000","40 ม.2 ต.ป่าเมือง อ.เมืองเชียงใหม่ จ.เชียงใหม่ 50100","50100","TH","1","SmartTax","1","","","1","","3500","","0","3500","","0","3500","non-vat","245","3500","3745",
                                "3500","","0","3500","7","3500","245","0","0","3745","","","","","tax_invoice","OutSystem001","20210805T00:00:00","5000","350","คำนวณเงินไม่ถูกต้อง","","","",""])